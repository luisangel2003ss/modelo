<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Informe Interactivo: Predicción de Derrames de Petróleo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #f8fafc;
      }
      .nav-link {
        transition: all 0.2s ease-in-out;
        border-left: 3px solid transparent;
      }
      .nav-link.active {
        border-left-color: #3b82f6;
        color: #3b82f6;
        background-color: #eff6ff;
      }
      .chart-container {
        position: relative;
        width: 100%;
        height: 350px;
        max-height: 40vh;
      }
      @media (min-width: 768px) {
        .chart-container {
          height: 400px;
        }
      }
      .stat-card {
        background-color: white;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -2px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s ease-in-out;
      }
      .stat-card:hover {
        transform: translateY(-5px);
      }
      .method-step {
        position: relative;
        padding-left: 2.5rem;
        padding-bottom: 2rem;
        border-left: 2px solid #e5e7eb;
      }
      .method-step:last-child {
        border-left: 2px solid transparent;
        padding-bottom: 0;
      }
      .method-icon {
        position: absolute;
        left: -1rem;
        top: 0;
        width: 2rem;
        height: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 9999px;
        background-color: white;
        border: 2px solid #e5e7eb;
      }
      .form-group {
        margin-bottom: 1.5rem;
      }
      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: #374151;
      }
      .form-group input,
      .form-group select {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        font-size: 1rem;
        transition: border-color 0.2s ease-in-out;
      }
      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      .predict-btn {
        background-color: #3b82f6;
        color: white;
        padding: 0.75rem 2rem;
        border: none;
        border-radius: 0.375rem;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.2s ease-in-out;
      }
      .predict-btn:hover {
        background-color: #2563eb;
      }
      .predict-btn:disabled {
        background-color: #9ca3af;
        cursor: not-allowed;
      }
      .result-card {
        background-color: #f0f9ff;
        border: 1px solid #0ea5e9;
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-top: 1.5rem;
      }
      .sidebar {
        background-color: #ffffff;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      }
      .main-content {
        background-color: #f8fafc;
      }
      .section-title {
        color: #1e293b;
      }
      .section-content {
        color: #475569;
      }
      .data-table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5rem 0;
        background-color: white;
        border-radius: 0.5rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      .data-table th,
      .data-table td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid #e5e7eb;
      }
      .data-table th {
        background-color: #f8fafc;
        font-weight: 600;
        color: #374151;
      }
      .data-table tr:hover {
        background-color: #f9fafb;
      }
      .figure {
        margin: 2rem 0;
        padding: 1rem;
        background-color: white;
        border-radius: 0.5rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      .figure p {
        font-style: italic;
        color: #6b7280;
        margin-bottom: 0.5rem;
      }
      #chartContainer {
        max-width: auto;           
        margin: auto;
        display: flex;
        justify-content: center;
      }

        #performanceChart {
        display: block;
        margin: auto;
        width: 600px;
        max-width: 1000px;
        height: auto !important;
      }

    </style>
  </head>
  <body class="bg-slate-50 text-slate-700">
        <div class="flex">
        <!-- Sidebar Navigation -->
        <aside class="sidebar sticky top-0 h-screen w-64 bg-white shadow-md hidden lg:block">
            <div class="p-6">
                <h2 class="text-xl font-bold text-slate-800">Menú del Informe</h2>
            </div>
            <nav id="nav-menu" class="flex flex-col px-3">
                <a href="#problem-statement" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Problema</a>
                <a href="#introduction" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Introducción</a>
                <a href="#objectives" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Objetivos</a>
                <a href="#summary" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Resumen y Métricas</a>
                <a href="#methodology" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Metodología</a>
                <a href="#experimentation" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Experimentación</a>
                <a href="#resultados" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Resultados Clave</a>
                <a href="#performance" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Rendimiento</a>
                <a href="#discussion" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Discusión</a>
                <a href="#predictions" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Predicciones</a>
                <a href="#web-application" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Aplicación Web</a>
                <a href="#conclusion" class="nav-link py-2 px-3 my-1 rounded-md font-medium text-slate-600 hover:bg-slate-100">Conclusiones</a>
            </nav>
        </aside>
        <!-- Main Content -->
        <main class="main-content w-full p-4 md:p-10">
            <div class="max-w-4xl mx-auto">
                <header class="mb-12 text-center">
                    <h1 class="text-4xl md:text-5xl font-bold text-slate-800 mb-2">Análisis de Derrames de Agua Producida en Texas (2013-2022)</h1>
                    <p class="text-xl text-slate-600">Un Vistazo Interactivo al Modelo Multitarea</p>
                </header>

                <!-- Section: Problem Statement -->
                <section id="problem-statement" class="mb-16">
                    <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">1. Problem Statement</h2>
                    <p class="section-content mb-4 text-lg">
                        Este proyecto analiza los derrames de agua producida reportados por la industria del petróleo y gas en Texas entre 2013 y 2022. Los datos provienen de informes oficiales de la Comisión de Ferrocarriles de Texas (RRC), detallando más de 10,000 incidentes durante este período. El conjunto de datos incluye variables como la fecha del derrame, el nombre del operador, el condado de ocurrencia, el tipo de operación, la fuente y la causa probable del derrame, y los volúmenes derramados y recuperados.
                    </p>
                    <p class="section-content mb-4 text-lg">
                        El agua producida contiene sustancias tóxicas como metales pesados, residuos de hidrocarburos y químicos utilizados en la fracturación hidráulica, lo que representa una amenaza significativa para el medio ambiente y la salud pública. Este análisis busca entender la magnitud, recurrencia y distribución espacial de tales incidentes para identificar zonas críticas, evaluar la responsabilidad del operador y proponer estrategias de gestión ambiental más efectivas.
                    </p>
                </section>

                <!-- Section: Introduction -->
                <section id="introduction" class="mb-16">
                    <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">2. Introducción</h2>
                    <p class="section-content mb-4 text-lg">
                        El agua producida representa riesgos ambientales y de salud significativos cuando no se gestiona adecuadamente. En Texas, se reportaron más de 10,000 derrames totalizando más de 148 millones de galones entre 2013 y 2022; solo alrededor del 40% de ese volumen fue recuperado, dejando el resto para impactar el suelo, el agua y los ecosistemas. El agua producida puede contener toxinas como benceno, metales pesados, radio y salinidad elevada, que se han relacionado con la degradación del suelo, la pérdida de vegetación, la mortalidad de la vida silvestre y la contaminación de acuíferos.
                    </p>
                    <div class="figure max-w-3xl mx-auto">
                        <p class="text-center">Figura 1: Visualización geográfica de derrames de agua producida en Texas usando QGIS.</p>
                        <div class="bg-slate-100 flex items-center justify-center rounded-md p-2">
                            <img src="img/mapa.png" alt="Figura 1: Mapa Derrames" class="max-w-full h-auto rounded" />
                        </div>
                    </div>
                </section>


                </section>

                <!-- Section: Objectives -->
                <section id="objectives" class="mb-16">
                    <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">3. Objetivos</h2>
                    <div class="mb-8">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">3.1 Objetivo General</h3>
                        <p class="section-content mb-4 text-lg">
                            Desarrollar un modelo multitarea basado en Keras que prediga simultáneamente el volumen de agua producida derramada y su causa probable, utilizando Optuna para la optimización de hiperparámetros.
                        </p>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-slate-800 mb-4">3.2 Objetivos Específicos</h3>
                        <ul class="section-content space-y-2 text-lg">
                            <li>• Preprocesar el conjunto de datos utilizando transformaciones logarítmicas, codificación one-hot y división de fechas.</li>
                            <li>• Diseñar una arquitectura neuronal con capas ocultas compartidas y cabezales separados para regresión y clasificación.</li>
                            <li>• Optimizar los hiperparámetros del modelo mediante Optuna en variables arquitectónicas y de entrenamiento.</li>
                            <li>• Evaluar utilizando R², MAE, MSE y Accuracy.</li>
                            <li>• Automatizar la identificación y reutilización de la mejor configuración para el despliegue.</li>
                        </ul>
                    </div>
                </section>

                <!-- Section 1: Summary & Key Metrics -->
                <section id="summary" class="mb-16">
                    <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">4. Resumen y Métricas Clave</h2>
                    <p class="section-content mb-8 text-lg">
                        Esta aplicación presenta un modelo de red neuronal diseñado para una doble tarea: predecir el <strong>volumen de agua derramada</strong> (regresión) y su <strong>causa probable</strong> (clasificación). Mediante la optimización automática con Optuna, el modelo logra un rendimiento prometedor, demostrando el potencial de los enfoques multitarea en contextos industriales complejos. A continuación se presentan los resultados finales más importantes.
                    </p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
                        <div class="stat-card">
                            <p class="text-sm font-medium text-slate-500">Coeficiente R² (Volumen)</p>
                            <p id="r2-value" class="text-4xl font-bold text-blue-600">0.347</p>
                        </div>
                        <div class="stat-card">
                            <p class="text-sm font-medium text-slate-500">Precisión (Causa)</p>
                            <p id="accuracy-value" class="text-4xl font-bold text-blue-600">49.8%</p>
                        </div>
                        <div class="stat-card">
                            <p class="text-sm font-medium text-slate-500">Error Absoluto Medio</p>
                            <p id="mae-value" class="text-4xl font-bold text-blue-600">1.279</p>
                        </div>
                        <div class="stat-card">
                            <p class="text-sm font-medium text-slate-500">Error Cuadrático Medio</p>
                            <p id="mse-value" class="text-4xl font-bold text-blue-600">2.764</p>
                        </div>
                    </div>
                </section>

                <!-- Section 2: Methodology -->
                <section id="methodology" class="mb-16">
                    <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">5. Metodología Interactiva</h2>
                    <p class="section-content mb-8 text-lg">El modelo fue construido siguiendo un flujo de trabajo automatizado que va desde el preprocesamiento de los datos hasta la optimización de la arquitectura de la red neuronal. Este enfoque asegura la reproducibilidad y facilita la mejora continua del sistema.</p>
                    
                    <div class="mb-8">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">5.1 Preparación de Datos</h3>
                        <ul class="section-content space-y-2 text-lg">
                            <li>• <strong>Valores faltantes:</strong> imputados utilizando la mediana y marcadores de posición 'Desconocido'.</li>
                            <li>• <strong>Transformación logarítmica:</strong> aplicada a los volúmenes de derrame para manejar la asimetría.</li>
                            <li>• <strong>Codificación:</strong> variables categóricas codificadas one-hot; fechas divididas en año/mes.</li>
                            <li>• <strong>Escalado:</strong> características normalizadas utilizando MinMaxScaler.</li>
                        </ul>
                    </div>
                    
                    <div>
                        <div class="method-step">
                            <div class="method-icon">📊</div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">1. Preprocesamiento de Datos</h3>
                            <p>Se utilizó un conjunto de datos real de derrames. Las variables categóricas (operador, condado, causa, etc.) fueron transformadas con <code>OneHotEncoder</code>, mientras que a la variable objetivo de volumen se le aplicó una transformación logarítmica para estabilizar la varianza.</p>
                        </div>
                        <div class="method-step">
                            <div class="method-icon">🧠</div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">2. Modelo de Red Neuronal Multitarea</h3>
                            <p>El núcleo del sistema es una red neuronal con capas compartidas que aprenden características comunes de los datos. El modelo se bifurca en dos salidas especializadas:</p>
                            <ul class="list-disc list-inside mt-2 space-y-1">
                                <li><strong class="text-blue-600">Salida de Regresión:</strong> Una capa densa con activación lineal para predecir el volumen del derrame.</li>
                                <li><strong class="text-blue-600">Salida de Clasificación:</strong> Una capa densa con activación Softmax para predecir la probabilidad de cada causa posible.</li>
                            </ul>
                        </div>
                        <div class="method-step">
                            <div class="method-icon">⚙️</div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">3. Optimización con Optuna</h3>
                            <p>Para encontrar la mejor configuración, se usó <strong>Optuna</strong>, un framework de optimización bayesiana que ajustó automáticamente los siguientes hiperparámetros clave para minimizar la pérdida combinada del modelo:</p>
                            <p class="font-mono text-sm bg-slate-100 p-3 rounded-md mt-2">Capas, Neuronas, Dropout, Regularización L2, Tasa de Aprendizaje, Optimizador, Tamaño de Lote.</p>
                        </div>
                    </div>
                </section>

                <!-- Section: Experimentation -->
                <section id="experimentation" class="mb-16">
                    <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">6. Experimentación y Resultados</h2>
                    <div class="mb-8">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">6.1 Plataforma Computacional</h3>
                        <p class="section-content mb-4 text-lg">
                            El desarrollo del modelo siguió un flujo de trabajo computacional estructurado. El prototipado inicial se realizó en el IDE Spyder, donde se diseñaron y probaron versiones tempranas de la red neuronal utilizando muestras pequeñas de datos y arquitecturas simplificadas. Una vez definida la arquitectura central, el proyecto migró a Google Colab para aprovechar su aceleración gratuita de GPU.
                        </p>
                    </div>
                    
                    <div class="mb-8">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">6.2 Análisis de Rendimiento del Modelo</h3>
                        <p class="section-content mb-4 text-lg">
                            Esta sección detalla el rendimiento de la red neuronal multitarea en varias métricas para la predicción del volumen de derrame (regresión) y la causa del derrame (clasificación).
                        </p>
                        
                        <!-- Pérdida Total -->
                        <div class="mb-8 max-w-3xl mx-auto">
                            <h4 class="text-lg font-bold text-slate-800 mb-4">Pérdida Total</h4>
                            <table class="data-table w-full">
                                <thead>
                                    <tr>
                                        <th>Época</th>
                                        <th>Pérdida de Entrenamiento</th>
                                        <th>Pérdida de Validación</th>
                                        <th>Diferencia</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>1</td><td>62.2842</td><td>45.1358</td><td>17.1484</td></tr>
                                    <tr><td>6</td><td>7.2674</td><td>4.8145</td><td>2.4529</td></tr>
                                    <tr><td>11</td><td>5.6395</td><td>4.6213</td><td>1.0182</td></tr>
                                    <tr><td>16</td><td>4.9681</td><td>4.6037</td><td>0.3645</td></tr>
                                    <tr><td>21</td><td>4.5250</td><td>4.6631</td><td>0.1382</td></tr>
                                    <tr><td>26</td><td>4.3510</td><td>4.6861</td><td>0.3352</td></tr>
                                    <tr><td>27</td><td>4.2380</td><td>4.7025</td><td>0.4644</td></tr>
                                </tbody>
                            </table>

                            <div class="figure mt-4">
                                <p class="text-center">Figura 2: Pérdida total de entrenamiento y validación por época.</p>
                                <div class="bg-slate-100 flex items-center justify-center rounded-md p-2">
                                    <img src="img/perdidatotal.png" alt="Figura 2: Pérdida total" class="max-w-full h-auto rounded" />
                                </div>
                            </div>
                        </div>


                        <!-- Precisión de Clasificación -->
                        <div class="mb-8 max-w-3xl mx-auto">
                            <h4 class="text-lg font-bold text-slate-800 mb-4">Precisión de Clasificación</h4>
                            <table class="data-table w-full">
                                <thead>
                                    <tr>
                                        <th>Época</th>
                                        <th>Precisión de Entrenamiento</th>
                                        <th>Precisión de Validación</th>
                                        <th>Diferencia</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>1</td><td>0.0726</td><td>0.0145</td><td>0.0581</td></tr>
                                    <tr><td>6</td><td>0.4658</td><td>0.4939</td><td>0.0281</td></tr>
                                    <tr><td>11</td><td>0.4837</td><td>0.4982</td><td>0.0145</td></tr>
                                    <tr><td>16</td><td>0.4930</td><td>0.5012</td><td>0.0082</td></tr>
                                    <tr><td>21</td><td>0.4988</td><td>0.4952</td><td>0.0036</td></tr>
                                    <tr><td>26</td><td>0.4989</td><td>0.5024</td><td>0.0035</td></tr>
                                    <tr><td>27</td><td>0.5032</td><td>0.5036</td><td>0.0005</td></tr>
                                </tbody>
                            </table>

                            <div class="figure mt-4">
                                <p class="text-center">Figura 3: Precisión de clasificación de entrenamiento y validación por época.</p>
                                <div class="bg-slate-100 flex items-center justify-center rounded-md p-2">
                                    <img src="img/accuracy.png" alt="Figura 3: Precisión" class="max-w-full h-auto rounded" />
                                </div>
                            </div>
                        </div>


                        <!-- MAE de Regresión -->
                        <div class="mb-8 max-w-3xl mx-auto">
                            <h4 class="text-lg font-bold text-slate-800 mb-4">MAE de Regresión (Error Absoluto Medio)</h4>
                            <table class="data-table w-full">
                                <thead>
                                    <tr>
                                        <th>Época</th>
                                        <th>MAE de Entrenamiento</th>
                                        <th>MAE de Validación</th>
                                        <th>Diferencia</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>1</td><td>7.1658</td><td>6.0034</td><td>1.1624</td></tr>
                                    <tr><td>6</td><td>1.8600</td><td>1.3799</td><td>0.4801</td></tr>
                                    <tr><td>11</td><td>1.5793</td><td>1.3305</td><td>0.2488</td></tr>
                                    <tr><td>16</td><td>1.4395</td><td>1.3250</td><td>0.1146</td></tr>
                                    <tr><td>21</td><td>1.3427</td><td>1.3326</td><td>0.0102</td></tr>
                                    <tr><td>26</td><td>1.3003</td><td>1.3313</td><td>0.0310</td></tr>
                                    <tr><td>27</td><td>1.2843</td><td>1.3365</td><td>0.0522</td></tr>
                                </tbody>
                            </table>

                            <div class="figure mt-4">
                                <p class="text-center">Figura 4: MAE de regresión de entrenamiento y validación por época.</p>
                                <div class="bg-slate-100 flex items-center justify-center rounded-md p-2">
                                    <img src="img/maeregresion.png" alt="Figura 4: MAE" class="max-w-full h-auto rounded" />
                                </div>
                            </div>
                        </div>


                        <!-- MSE de Regresión -->
                        <div class="mb-8">
                            <h4 class="text-lg font-bold text-slate-800 mb-4">MSE de Regresión (Error Cuadrático Medio)</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Época</th>
                                        <th>MSE de Entrenamiento</th>
                                        <th>MSE de Validación</th>
                                        <th>Diferencia</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>106.2713</td>
                                        <td>89.1004</td>
                                        <td>17.1709</td>
                                    </tr>
                                    <tr>
                                        <td>6</td>
                                        <td>7.8123</td>
                                        <td>5.7045</td>
                                        <td>2.1078</td>
                                    </tr>
                                    <tr>
                                        <td>11</td>
                                        <td>6.4232</td>
                                        <td>5.2283</td>
                                        <td>1.1949</td>
                                    </tr>
                                    <tr>
                                        <td>16</td>
                                        <td>5.5246</td>
                                        <td>5.1487</td>
                                        <td>0.3759</td>
                                    </tr>
                                    <tr>
                                        <td>21</td>
                                        <td>5.1062</td>
                                        <td>5.1610</td>
                                        <td>0.0548</td>
                                    </tr>
                                    <tr>
                                        <td>26</td>
                                        <td>4.9517</td>
                                        <td>5.1889</td>
                                        <td>0.2372</td>
                                    </tr>
                                    <tr>
                                        <td>27</td>
                                        <td>4.8493</td>
                                        <td>5.2098</td>
                                        <td>0.3605</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                	</div>
            	</div>
        	</section>

       	 <!-- Section: Discussion -->
        	<section id="discussion" class="mb-16">
          	  <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">7. Discusión</h2>
           	 <p class="section-content mb-4 text-lg">
                A pesar de las limitaciones en la precisión de las predicciones, los resultados muestran una clara tendencia hacia la mejora del modelo con el aumento de datos y la optimización. El desempeño de la regresión (R² ≈ 0.35) y clasificación (≈ 50%) sugiere que el enfoque multitarea puede capturar patrones útiles incluso en conjuntos de datos con ruido e incertidumbre.
         	   </p>
           	 <p class="section-content mb-4 text-lg">
                Se identificaron operadores y condados con altas tasas de derrames, lo que puede guiar intervenciones regulatorias. Además, la causa más común de los derrames fue el fallo de equipos, destacando la necesidad de mantenimiento preventivo en infraestructura.
           	 </p>
       	 </section>

       	 <!-- Section: Web Application -->
       	 <section id="web-application" class="mb-16">
<div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto mt-8">
  <form id="predictionForm" class="space-y-4">
    <div class="form-group">
      <label for="year">Año:</label>
      <input type="number" id="year" class="border rounded p-2 w-full" required>
    </div>
    <div class="form-group">
      <label for="month">Mes:</label>
      <select id="month" class="border rounded p-2 w-full">
        <option value="1">Enero</option>
        <option value="2">Febrero</option>
        <option value="3">Marzo</option>
        <option value="4">Abril</option>
        <option value="5">Mayo</option>
        <option value="6">Junio</option>
        <option value="7">Julio</option>
        <option value="8">Agosto</option>
        <option value="9">Septiembre</option>
        <option value="10">Octubre</option>
        <option value="11">Noviembre</option>
        <option value="12">Diciembre</option>
      </select>
    </div>
    <div class="form-group">
      <label for="operator">Operador:</label>
      <select id="operator" class="border rounded p-2 w-full">
        <option value="0">APACHE</option>
        <option value="1">CLIMAREX ENERGY</option>
        <option value="2">JONES ENERGY</option>
        <option value="3">LAREDO PETROLEUM</option>
      </select>
    </div>
    <div class="form-group">
      <label for="county">Condado:</label>
      <select id="county" class="border rounded p-2 w-full">
        <option value="0">Glasscock</option>
        <option value="1">Roberts</option>
        <option value="2">Lipscomb</option>
        <option value="3">Reagan</option>
      </select>
    </div>
    <div class="form-group">
      <label for="type_operation">Tipo de operación:</label>
      <select id="type_operation" class="border rounded p-2 w-full">
        <option value="0">PRODUCTION</option>
        <option value="1">INJECTION/DISPOSAL</option>
      </select>
    </div>
    <div class="form-group">
      <label for="source">Fuente:</label>
      <select id="source" class="border rounded p-2 w-full">
        <option value="0">TANK</option>
        <option value="1">WELL</option>
      </select>
    </div>
    <button type="submit" class="predict-btn">Predecir</button>
  </form>
  <div id="result" class="result-card mt-4 hidden">
    <p class="text-lg font-semibold">Predicción:</p>
    <p id="predictionOutput" class="text-xl text-blue-600 mt-2"></p>
  </div>
</div>

         	   <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">8. Aplicación Web</h2>
         	   <p class="section-content mb-4 text-lg">
                Se desarrolló una aplicación web interactiva que permite cargar datos y predecir en tiempo real tanto el volumen estimado de agua derramada como su causa probable. Esta herramienta puede ser utilizada por reguladores, investigadores y operadores para monitorear riesgos y responder de forma proactiva.
         	   </p>
          	
        	</section>

       	 <!-- Section: Resultados Clave -->
      <section id="resultados" class="mb-16">
        <h2 class="text-3xl font-bold mb-6 border-b-2 border-slate-200">Resultados Clave</h2>
        <p class="mb-8 text-lg">Visualización de regresión y clasificación sobre datos reales.</p>
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
          <div class="lg:col-span-3 bg-white p-4 rounded-lg shadow">
            <h3 class="text-xl font-bold mb-2 text-center">Predicción de Volumen</h3>
            <div class="chart-container"><canvas id="regressionChart"></canvas></div>
          </div>
          <div class="lg:col-span-2 bg-white p-4 rounded-lg shadow">
            <h3 class="text-xl font-bold mb-2 text-center">Predicción de Causa</h3>
            <div class="chart-container"><canvas id="classificationChart"></canvas></div>
          </div>
        </div>
      </section>

      <!-- Sección: Rendimiento -->
      <section id="performance" class="mb-16">
        <h2 class="text-3xl font-bold mb-6 border-b-2 border-slate-200">Explorador de Rendimiento</h2>
        <p class="mb-6 text-lg">Explora cómo evolucionaron las métricas a lo largo de las épocas de entrenamiento.</p>
        <div class="bg-white p-4 rounded-lg shadow">
          <div class="flex flex-wrap justify-center gap-2 mb-4">
            <button onclick="updatePerformanceChart('loss')" class="bg-blue-500 text-white py-2 px-4 rounded-md">Pérdida Total</button>
            <button onclick="updatePerformanceChart('accuracy')" class="bg-slate-200 text-slate-700 py-2 px-4 rounded-md">Precisión</button>
            <button onclick="updatePerformanceChart('mae')" class="bg-slate-200 text-slate-700 py-2 px-4 rounded-md">MAE</button>
          </div>
          <div class="chart-container"><canvas id="performanceChart"></canvas></div>
        </div>
      </section>

        <!-- Section: Conclusiones -->
        <section id="conclusion" class="mb-16">
            <h2 class="section-title text-3xl font-bold mb-6 pb-2 border-b-2 border-slate-200">9. Conclusiones</h2>
            <p class="section-content mb-4 text-lg">
                Este proyecto demuestra el potencial de la inteligencia artificial para abordar problemas ambientales complejos. El modelo multitarea logró resultados competitivos en la predicción de variables clave, y su integración con una interfaz web proporciona un sistema práctico para usuarios no técnicos.
            </p>
            <p class="section-content mb-4 text-lg">
                Como futuras mejoras, se plantea incrementar el volumen de datos, refinar el tratamiento de valores atípicos y explorar arquitecturas más sofisticadas como redes recurrentes o transformers para aprovechar patrones temporales más complejos.
            </p>
        </section>

        </main>
    </div>

        <!-- Script Chart.js -->
        <script defer>
            const lossData = {
            labels: [1, 6, 11, 16, 21, 26, 27],
            datasets: [
                {
                label: 'Pérdida de Entrenamiento',
                data: [62.2842, 7.2674, 5.6395, 4.9681, 4.5250, 4.3510, 4.2380],
                borderColor: '#3b82f6', fill: false, tension: 0.3
                },
                {
                label: 'Pérdida de Validación',
                data: [45.1358, 4.8145, 4.6213, 4.6037, 4.6631, 4.6861, 4.7025],
                borderColor: '#f59e0b', fill: false, tension: 0.3
                }
            ]
            };

            const accuracyData = {
            labels: [1, 6, 11, 16, 21, 26, 27],
            datasets: [{
                label: 'Precisión Validación',
                data: [0.0145, 0.4939, 0.4982, 0.5012, 0.4952, 0.5024, 0.5036],
                borderColor: '#10b981', fill: false, tension: 0.3
            }]
            };

            const maeData = {
            labels: [1, 6, 11, 16, 21, 26, 27],
            datasets: [{
                label: 'MAE Validación',
                data: [6.0034, 1.3799, 1.3305, 1.3250, 1.3326, 1.3313, 1.3365],
                borderColor: '#ef4444', fill: false, tension: 0.3
            }]
            };

            const chartConfigs = {
            loss: lossData,
            accuracy: accuracyData,
            mae: maeData
            };

            let performanceChart;
            function updatePerformanceChart(metric) {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            if (performanceChart) performanceChart.destroy();
            performanceChart = new Chart(ctx, {
                type: 'line',
                data: chartConfigs[metric],
                options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top' },
                    title: { display: true, text: `Evolución de ${metric.toUpperCase()}` }
                }
                }
            });
            }

            // Gráficas de Resultados Clave
            new Chart(document.getElementById('regressionChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                label: 'Volumen Real vs Predicho',
                data: [
                    {x: 1.1, y: 1.2}, {x: 2.0, y: 2.1}, {x: 3.5, y: 3.4},
                    {x: 4.0, y: 4.1}, {x: 5.0, y: 5.3}
                ],
                backgroundColor: '#3b82f6'
                }]
            },
            options: {
                scales: {
                x: { title: { display: true, text: 'Volumen Real' } },
                y: { title: { display: true, text: 'Volumen Predicho' } }
                }
            }
            });

            new Chart(document.getElementById('classificationChart'), {
            type: 'doughnut',
            data: {
                labels: ['Corrosión', 'Mecánico', 'Desconocido'],
                datasets: [{
                label: 'Distribución de Causas',
                data: [45, 30, 25],
                backgroundColor: ['#3b82f6', '#f59e0b', '#10b981']
                }]
            },
            options: {
                plugins: {
                legend: { position: 'bottom' }
                }
            }
            });
        </script>
    
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script>
  let model; // variable global

  // ✅ Cargar el modelo
  async function loadModel() {
    try {
      model = await tf.loadLayersModel('model.json');
      console.log("✅ Modelo cargado correctamente");
    } catch (error) {
      console.error("❌ Error al cargar el modelo:", error);
      alert("No se pudo cargar el modelo. Revisa la consola para más detalles.");
    }
  }

  // ✅ Preprocesar entrada
  function preprocess(year, month, operator, county, type_operation, source) {
    return tf.tensor2d([[year, month, operator, county, type_operation, source]]);
  }

  // ✅ Ejecutar después de que el DOM cargue
  document.addEventListener("DOMContentLoaded", () => {
    loadModel(); // Cargar modelo al inicio

    // Escuchar evento de formulario
    document.getElementById("predictionForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      try {
        if (!model) {
          alert("El modelo aún no ha sido cargado.");
          return;
        }

        const year = parseInt(document.getElementById("year").value);
        const month = parseInt(document.getElementById("month").value);
        const operator = parseInt(document.getElementById("operator").value);
        const county = parseInt(document.getElementById("county").value);
        const type_operation = parseInt(document.getElementById("type_operation").value);
        const source = parseInt(document.getElementById("source").value);

        const inputTensor = preprocess(year, month, operator, county, type_operation, source);
        const prediction = model.predict(inputTensor);
        const result = await prediction.data();

        const output = document.getElementById("predictionOutput");
        output.innerText = `${result[0].toFixed(2)} galones`;

        document.getElementById("result").classList.remove("hidden");
      } catch (error) {
        console.error("❌ Error durante la predicción:", error);
        alert("Hubo un problema al predecir. Revisa la consola para más detalles.");
      }
    });
  });
</script>

</body>
</html>
